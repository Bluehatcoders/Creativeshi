document.addEventListener("DOMContentLoaded", () => {
  const e = document.querySelector("footer"),
    t =
      (document.querySelector(".laptop"),
      ["#3949ab", "#ff0000", "#00aced", "#24292e", "#e4405f"]),
    n =
      (document.querySelector("body"),
      document.querySelector("nav"),
      document.querySelector("#myIntro"),
      document.querySelector("#aboutMeBox")),
    o = document.querySelectorAll(".projectContainer"),
    r = document.querySelector("#projectOpener"),
    s = document.querySelector("span.closeBtn"),
    c = document.querySelector("#embedContent"),
    l = document.querySelectorAll(".loader>span"),
    i = document.querySelector(".loader"),
    a = document.querySelector(".url>.name"),
    u = document.querySelectorAll("#social-links > a");
  u.forEach((n, o) =>
    n.addEventListener("mouseover", () => (e.style.backgroundColor = t[o]))
  ),
    u.forEach((t, n) =>
      t.addEventListener("mouseout", () => (e.style.backgroundColor = ""))
    ),
    u.forEach((e) =>
      e.addEventListener("click", (t) => {
        t.preventDefault(),
          setTimeout(() => {
            let t = e.getAttribute("href");
            window.open(t, "_blank").focus();
          }, 500);
      })
    );
  const d = document.querySelector(".animBox1"),
    m = document.querySelector(".animBox2"),
    y = document.querySelector(".animBox3"),
    p = [d, m, y],
    h = [
      document.querySelector(".animLine1"),
      document.querySelector(".animLine2"),
      document.querySelector(".animLine3"),
    ],
    f = ["rLeftBox", "rCentreBox", "rRightBox"],
    v = ["hSideLine", "hCentreLine", "hSideLine"];
  document.querySelectorAll(".aboutText").forEach((e) => {
    e.addEventListener("click", (e) => {
      let t = e.currentTarget.parentElement;
      function n(e) {
        if (t.classList.contains(e)) {
          let n = document.querySelector(".rCentreBox"),
            o = document.querySelector(`.${e} > .hSideLine`);
          document
            .querySelector(".hCentreLine")
            .classList.replace("hCentreLine", "hSideLine"),
            o.classList.replace("hSideLine", "hCentreLine"),
            n.classList.replace("rCentreBox", e),
            t.classList.replace(e, "rCentreBox");
        }
      }
      n("rLeftBox"), n("rRightBox");
    });
  });
  const S = document.querySelector("#webdev"),
    g = document.querySelector("#design"),
    L = document.querySelector("#electronics");
  let q;
  d.addEventListener("click", () => {
    (S.style.display = "flex"),
      (g.style.display = "none"),
      (L.style.display = "none");
  }),
    m.addEventListener("click", () => {
      (g.style.display = "flex"),
        (S.style.display = "none"),
        (L.style.display = "none");
    }),
    y.addEventListener("click", () => {
      (L.style.display = "flex"),
        (g.style.display = "none"),
        (S.style.display = "none");
    });
  let b,
    T = 1,
    E = 0;
  let w = !1;
  o.forEach((e) => {
    e.addEventListener("click", (e) => {
      w || (N("Click on URL to open"), (w = !0)),
        (r.style.display = "block"),
        (i.style.display = "flex"),
        (function e() {
          q = setInterval(() => {
            l.forEach((e, t) => {
              setTimeout(() => {
                e.classList.add("popUp");
              }, 200 * t),
                setTimeout(() => {
                  e.classList.remove("popUp");
                }, 260 * ++t);
            }),
              setTimeout(() => {
                [...l]
                  .slice()
                  .reverse()
                  .forEach((e, t) => {
                    setTimeout(() => {
                      e.classList.add("popUp");
                    }, 230 * t),
                      setTimeout(() => {
                        e.classList.remove("popUp");
                      }, 280 * ++t);
                  });
              }, 1300),
              1 === T && ((E = 2700), clearInterval(q), e()),
              T++;
          }, E);
        })(),
        (b = "https://creativeshi.com/" + e.currentTarget.id),
        (a.innerHTML = e.currentTarget.id);
      let t = document.createElement("embed");
      t.addEventListener("load", () => {
        clearInterval(q),
          (T = 1),
          (E = 0),
          setTimeout(() => {
            (i.style.display = "none"), (c.style.visibility = "visible");
          }, 1500);
      }),
        setTimeout(() => {
          (t.src = b), c.appendChild(t);
        }, 300),
        document.documentElement.style.setProperty(
          "--clientX",
          e.clientX + "px"
        ),
        document.documentElement.style.setProperty(
          "--clientY",
          e.clientY + "px"
        );
    });
  }),
    a.parentElement.addEventListener("click", () => {
      window.open(b, "_blank").focus();
    }),
    s.addEventListener("click", () => {
      const e = document.querySelector("embed");
      e && e.remove(),
        clearInterval(q),
        (T = 1),
        (E = 0),
        (c.style.visibility = "hidden"),
        (r.style.display = "none");
    }),
    document.documentElement.style.setProperty("--aboutMeRotate", "43deg"),
    document.documentElement.style.setProperty(
      "--screenHeight",
      window.innerHeight + "px"
    );
  const k =
      "Hey! Whatsup guys I am Shivam, A self taught creative guy who loves ❤️ to design and develop creative things and to make people laugh 😀",
    x = document.querySelector("#typingBox");
  let C = 0;
  const A = 25;
  let B;
  var H = {
    rocket: { url: "assets/sounds/rocketFly.mp3" },
    swoosh: { url: "assets/sounds/swoosh.mp3" },
  };
  function M(e) {
    var t = H[e],
      n = t.url,
      o = (t.buffer, new XMLHttpRequest());
    o.open("GET", n, !0),
      (o.responseType = "arraybuffer"),
      (o.onload = function () {
        B.decodeAudioData(o.response, function (e) {
          t.buffer = e;
        });
      }),
      o.send();
  }
  function P(e, t) {
    var n = H[e],
      o = H[e].volume || 1,
      r = n.buffer;
    if (r) {
      var s = B.createBufferSource();
      s.buffer = r;
      var c = B.createGain();
      t ? t.volume && (c.gain.value = o * t.volume) : (c.gain.value = o),
        c.connect(B.destination),
        s.connect(c),
        s.start(0);
    }
  }
  const I = document.querySelector("#enterBtn"),
    R = document.querySelector("#mainContent"),
    F = (document.querySelector("#intro"), document.querySelector("#intro1")),
    j = document.querySelector("#intro2"),
    z = document.querySelector("main"),
    U = document.querySelector("#pageLoader"),
    D = document.querySelector("#message");
  function N(e) {
    setTimeout(() => {
      (D.innerHTML = e),
        (D.style.right = "-40px"),
        setTimeout(() => {
          D.style.right = "";
        }, 3e3);
    }, 700);
  }
  let $ = !1,
    O = !1,
    X = !1,
    Y = !1,
    _ = 0;
  const G = document.querySelector("#learned"),
    J = document.querySelector("#myProjects");
  function W(e) {
    let t = z.scrollTop;
    const n = e.offsetTop,
      o = e.offsetHeight;
    return t > n - 300 && t < o + n - 300;
  }
  function K() {
    var e;
    !(function () {
      for (var e in ((B = new (window.AudioContext ||
        window.webkitAudioContext)()),
      H))
        M(e);
    })(),
      (U.style.display = "none"),
      (R.style.display = "block"),
      (function () {
        var e = document.getElementById("smoke"),
          t = e.getContext("2d");
        (e.width = 1e3), (e.height = 1e3);
        var n = smokemachine(t, [255, 255, 255]);
        setTimeout(function () {
          n.addsmoke(500, 720, 10),
            n.addsmoke(500, 900, 20),
            n.addsmoke(450, 900, 20),
            n.addsmoke(550, 900, 20);
          for (var e = 0; e < 10; e++) n.step(10);
          n.start();
        }, 2e3);
      })(),
      B.resume(),
      setTimeout(() => {
        P("rocket");
      }, 4300),
      setTimeout(() => {
        P("swoosh");
      }, 12300),
      P("swoosh"),
      setTimeout(() => {
        F.remove(),
          j.classList.add("intro2Anim"),
          setTimeout(() => {
            e = setInterval(function () {
              C == k.length
                ? (this.clearTimeout(e),
                  (x.innerHTML = k + '<span id="blinki">|</span>'))
                : ((document.querySelector("#typingBox").innerHTML =
                    k.slice(0, C + 1) + "|"),
                  C++);
            }, 1e3 / A);
          }, 1e3),
          setTimeout(() => {
            (n.style.display = "block"),
              z.scrollTo({ top: window.innerHeight, behavior: "smooth" });
          }, 8e3);
      }, 12700);
  }
  z.addEventListener("scroll", () => {
    if (!$ && W(n)) {
      (document.getElementById("aboutMePlayer").style.display = "flex"),
        ($ = !0);
    }
    if (
      (O ||
        (W(G) &&
          (h.forEach((e, t) => {
            e.classList.add(v[t]),
              setTimeout(() => {
                e.style.transitionTimingFunction = "ease";
              }, 1e3);
          }),
          setTimeout(() => {
            p.forEach((e, t) => {
              e.classList.add(f[t]),
                setTimeout(() => {
                  e.style.transitionTimingFunction = "ease";
                }, 1e3);
            });
          }, 550),
          N("Touch The Balls"),
          (O = !0))),
      !Y && W(J))
    ) {
      for (let e = 0; e < o.length; e++)
        setTimeout(() => {
          o[e].classList.add("projectPop");
        }, _),
          (_ += 200);
      N("Click To Preview"), (Y = !0);
    }
    const e = document.querySelector(".bottomSection");
    X ||
      (W(e) &&
        (grecaptcha.ready(function () {
          grecaptcha
            .execute("6Le1toEUAAAAAITyNwqEMaz3hFAYzciSJDMomrgN", {})
            .then(function (e) {
              (oe = e), document.querySelector(".grecaptcha-badge").remove();
            });
        }),
        console.log("Recaptcha excuted"),
        (X = !0)));
  });
  const Q = document.querySelector("#myFriends");
  let V;
  const Z = ["ezioda004", "bushblade", "razvanlikespizza"];
  Z.forEach((e, t) => {
    ((e) => {
      let t = "https://api.github.com/users/" + Z[e];
      fetch(t)
        .then((e) => e.json())
        .then((e) => {
          (V = `<a href='${e.blog}'><div><img src='${e.avatar_url}&s=200' alt='${e.name}'>\n                            <h2>${e.name}</div></h2></a>`),
            (Q.innerHTML += V);
        });
    })(t);
  }),
    I.addEventListener("click", () => {
      if (window.innerHeight < 630) {
        var e = document.documentElement;
        (
          e.requestFullscreen ||
          e.webkitRequestFullScreen ||
          e.mozRequestFullScreen ||
          e.msRequestFullscreen
        ).call(e);
      }
      setTimeout(() => {
        document.documentElement.style.setProperty(
          "--screenHeight",
          window.innerHeight + "px"
        ),
          I.parentElement.remove();
      }, 500),
        K();
    }),
    (document.onreadystatechange = function () {
      "complete" === document.readyState && (I.style.display = "block");
    });
  const ee = document.querySelector("form"),
    te = document.querySelector("#status"),
    ne = document.querySelector("form>button");
  let oe;
  (/constructor/i.test(window.HTMLElement) ||
    "[object SafariRemoteNotification]" ===
      (
        !window.safari ||
        ("undefined" != typeof safari && safari.pushNotification)
      ).toString()) &&
    (ee.elements.message.setAttribute(
      "placeholder",
      "Please switch to another browser Safari can't send message!"
    ),
    ee.elements.name.setAttribute("disabled", !0),
    ee.elements.email.setAttribute("disabled", !0),
    ee.elements.message.setAttribute("disabled", !0));
  const re = (e) => {
    const t = {
      method: "POST",
      body: JSON.stringify(e),
      headers: new Headers({ "Content-Type": "application/json" }),
    };
    return fetch("https://xmailerr.glitch.me/contact", t)
      .then((e) => e.json())
      .then((e) =>
        ((e) => {
          (te.innerHTML = e.status),
            (te.style.display = "block"),
            (ne.innerHTML = "Send"),
            ee.reset(),
            setTimeout(() => {
              te.style.display = "none";
            }, 3e3);
        })(e)
      )
      .catch((e) => console.log(e));
  };
  ee.addEventListener("submit", (e) => {
    e.preventDefault(), (ne.innerHTML = "Sending...");
    let t = {
      name: ee.elements.name.value,
      email: ee.elements.email.value,
      message: ee.elements.message.value,
      captcha: oe,
    };
    re(t);
  });
});
